---
import BaseLayout from '../../layouts/BaseLayout.astro';
import ArticleCard from '../../components/ArticleCard.astro';
import { getPosts } from '../../lib/db';
import { t, translations } from '../../lib/i18n';

const db = Astro.locals.runtime.env.DB;
const posts = await getPosts(db, { limit: 12 });
const locale = (Astro.locals as any).locale || 'id';
const tr = translations.blog;
---

<BaseLayout title={t(tr.title, locale)}>
  <div class="container mx-auto px-4 py-12">
    <h1 class="text-4xl font-bold mb-8">{t(tr.title, locale)}</h1>
    
    <div class="grid md:grid-cols-3 gap-6">
      {posts.map(post => (
        <ArticleCard post={post} locale={locale} />
      ))}
    </div>
    
    {posts.length === 0 && (
      <p class="text-gray-500 text-center py-12">
        {t(tr.no_posts, locale)}
      </p>
    )}
  </div>
</BaseLayout>
