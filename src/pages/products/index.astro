---
// src/pages/products/index.astro
import BaseLayout from '../../layouts/BaseLayout.astro';
import ProductCard from '../../components/ProductCard.astro';
import { getProducts } from '../../lib/db';
import { t, translations } from '../../lib/i18n';

const db = Astro.locals.runtime.env.DB;
const products = await getProducts(db, 20);
const locale = (Astro.locals as any).locale || 'id';
const tr = translations.products;
---

<BaseLayout title={t(tr.title, locale)}>
  <div class="container mx-auto px-4 py-12">
    <h1 class="text-4xl font-bold mb-8">{t(tr.title, locale)}</h1>
    
    <div class="grid md:grid-cols-4 gap-6">
      {products.map(product => (
        <ProductCard product={product} locale={locale} />
      ))}
    </div>
    
    {products.length === 0 && (
      <p class="text-gray-500 text-center py-12">{t(tr.no_products, locale)}</p>
    )}
  </div>
</BaseLayout>
